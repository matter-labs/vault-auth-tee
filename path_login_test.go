// SPDX-License-Identifier: MPL-2.0
// Copyright (c) HashiCorp, Inc.
// Copyright (c) Matter Labs

package vault_auth_tee

import (
	"context"
	"crypto/tls"
	"fmt"
	"net"
	"net/http"
	"strings"
	"testing"
	"time"

	logicaltest "github.com/hashicorp/vault/helper/testhelpers/logical"
	"github.com/hashicorp/vault/sdk/logical"
)

var ocspPort int

var source InMemorySource

type testLogger struct{}

func (t *testLogger) Log(args ...any) {
	fmt.Printf("%v", args)
}

func TestMain(m *testing.M) {
	source = make(InMemorySource)

	listener, err := net.Listen("tcp", ":0")
	if err != nil {
		return
	}

	ocspPort = listener.Addr().(*net.TCPAddr).Port
	srv := &http.Server{
		Addr:    "localhost:0",
		Handler: NewResponder(&testLogger{}, source, nil),
	}
	go func() {
		srv.Serve(listener)
	}()
	defer srv.Shutdown(context.Background())
	m.Run()
}

func TestTee_RoleResolve(t *testing.T) {
	connState, err := testConnState("test-fixtures/keys/cert.pem",
		"test-fixtures/keys/key.pem", "test-fixtures/keys/cert.pem")
	if err != nil {
		t.Fatalf("error testing connection state: %v", err)
	}

	quoteBase64 := `AwACAAAAAAAJAA4Ak5pyM/ecTKmUCg2zlX8GB2A9AU1uxwxpErEhhnbcltYAAAAACwsQD///AQAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAADnAAAAAAAAABiUazVH08oDb033tRaFfij9US1p/tNBHcZgU3kS+qv4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApgDfYh4LgIuAZswIHRbeKpA7ZXHfaS/fzJT06RMT9fgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACZe/ri1/kInRdrGLXO8tgd7B/R3DMumyPFU8TgL+PkqwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAxhAAAPvTSIG+2X8S4ne9Zsb8a5wqVabUhgr7r3GlpScrLaGMv8RDLVr9n8O/9CfASa11lqkO1DT+JqFTu+5Mitjp2rm/ptkyoG99YfjwdzdsURZQvQCidBDdhrt1kcr+7HwTFcf1hbifB13klNa6Npsm5sc7SMgVXrVM98+zCj0+jTleCwsQD///AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFQAAAAAAAADnAAAAAAAAABkqpQzhwM7wPM+J57Wxaw15ePXCse3Pd02HcC6BVNi/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMT1d115ZQPpYTf3fGioKaAFasje1wFAsIGwlEkMV7/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEACQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADLZrH69IGHR4/H2DCpkrZPl4lJ7yWZvpARseCwUJ/wmwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGrO+CXpMIu8FYYaLb9gwNsNegCmkZgK72V9wj8LDQmJlvUfpZ+qz4tYm5HucJK8ulPfQMCRoFowZFxLlXF1EiAAAAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8FAF4OAAAtLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJRThUQ0NCSmlnQXdJQkFnSVVEMkNQQzRleDNQcnB6UE9YRXBuVTIrNDMzYm93Q2dZSUtvWkl6ajBFQXdJdwpjREVpTUNBR0ExVUVBd3daU1c1MFpXd2dVMGRZSUZCRFN5QlFiR0YwWm05eWJTQkRRVEVhTUJnR0ExVUVDZ3dSClNXNTBaV3dnUTI5eWNHOXlZWFJwYjI0eEZEQVNCZ05WQkFjTUMxTmhiblJoSUVOc1lYSmhNUXN3Q1FZRFZRUUkKREFKRFFURUxNQWtHQTFVRUJoTUNWVk13SGhjTk1qTXdOVEV3TWpBeU5EVTJXaGNOTXpBd05URXdNakF5TkRVMgpXakJ3TVNJd0lBWURWUVFEREJsSmJuUmxiQ0JUUjFnZ1VFTkxJRU5sY25ScFptbGpZWFJsTVJvd0dBWURWUVFLCkRCRkpiblJsYkNCRGIzSndiM0poZEdsdmJqRVVNQklHQTFVRUJ3d0xVMkZ1ZEdFZ1EyeGhjbUV4Q3pBSkJnTlYKQkFnTUFrTkJNUXN3Q1FZRFZRUUdFd0pWVXpCWk1CTUdCeXFHU000OUFnRUdDQ3FHU000OUF3RUhBMElBQkR1ZQpDOFl2L1JnZ2V5cnV5cWpmUlhydk1ZRjBoUnhRd1dueW9oVXQvd2VjeUxlL2YyREdZSGk1RlNGLzZnUmlTOC9WCjZiYld6bXEycTBsZm9Mei9hMEdqZ2dNT01JSURDakFmQmdOVkhTTUVHREFXZ0JTVmIxM052UnZoNlVCSnlkVDAKTTg0QlZ3dmVWREJyQmdOVkhSOEVaREJpTUdDZ1hxQmNobHBvZEhSd2N6b3ZMMkZ3YVM1MGNuVnpkR1ZrYzJWeQpkbWxqWlhNdWFXNTBaV3d1WTI5dEwzTm5lQzlqWlhKMGFXWnBZMkYwYVc5dUwzWXpMM0JqYTJOeWJEOWpZVDF3CmJHRjBabTl5YlNabGJtTnZaR2x1Wnoxa1pYSXdIUVlEVlIwT0JCWUVGSi95dmhxV0lBd0prOTJIbXpjSWtreWcKMUFDQU1BNEdBMVVkRHdFQi93UUVBd0lHd0RBTUJnTlZIUk1CQWY4RUFqQUFNSUlDT3dZSktvWklodmhOQVEwQgpCSUlDTERDQ0FpZ3dIZ1lLS29aSWh2aE5BUTBCQVFRUXFmNzBJOGRnYksweGVtaEY0TExIM3pDQ0FXVUdDaXFHClNJYjRUUUVOQVFJd2dnRlZNQkFHQ3lxR1NJYjRUUUVOQVFJQkFnRUxNQkFHQ3lxR1NJYjRUUUVOQVFJQ0FnRUwKTUJBR0N5cUdTSWI0VFFFTkFRSURBZ0VETUJBR0N5cUdTSWI0VFFFTkFRSUVBZ0VETUJFR0N5cUdTSWI0VFFFTgpBUUlGQWdJQS96QVJCZ3NxaGtpRytFMEJEUUVDQmdJQ0FQOHdFQVlMS29aSWh2aE5BUTBCQWdjQ0FRRXdFQVlMCktvWklodmhOQVEwQkFnZ0NBUUF3RUFZTEtvWklodmhOQVEwQkFna0NBUUF3RUFZTEtvWklodmhOQVEwQkFnb0MKQVFBd0VBWUxLb1pJaHZoTkFRMEJBZ3NDQVFBd0VBWUxLb1pJaHZoTkFRMEJBZ3dDQVFBd0VBWUxLb1pJaHZoTgpBUTBCQWcwQ0FRQXdFQVlMS29aSWh2aE5BUTBCQWc0Q0FRQXdFQVlMS29aSWh2aE5BUTBCQWc4Q0FRQXdFQVlMCktvWklodmhOQVEwQkFoQUNBUUF3RUFZTEtvWklodmhOQVEwQkFoRUNBUTB3SHdZTEtvWklodmhOQVEwQkFoSUUKRUFzTEF3UC8vd0VBQUFBQUFBQUFBQUF3RUFZS0tvWklodmhOQVEwQkF3UUNBQUF3RkFZS0tvWklodmhOQVEwQgpCQVFHQUdCcUFBQUFNQThHQ2lxR1NJYjRUUUVOQVFVS0FRRXdIZ1lLS29aSWh2aE5BUTBCQmdRUUtEbyt6dWdoCjhaY0xBME9hM3BSa2REQkVCZ29xaGtpRytFMEJEUUVITURZd0VBWUxLb1pJaHZoTkFRMEJCd0VCQWY4d0VBWUwKS29aSWh2aE5BUTBCQndJQkFRQXdFQVlMS29aSWh2aE5BUTBCQndNQkFRQXdDZ1lJS29aSXpqMEVBd0lEUndBdwpSQUlnRHBmZFptVE5IYnVRaFE0c0ZMSnZ5czIzY2ZxdWR1ODBZcUlEVm5ud2NPRUNJRmhUMFF2R2xqS1FSM2NvClBqOGhoSFQ5anVWYXFkM1RydE1YRDFQZEhZWHYKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJQ2xqQ0NBajJnQXdJQkFnSVZBSlZ2WGMyOUcrSHBRRW5KMVBRenpnRlhDOTVVTUFvR0NDcUdTTTQ5QkFNQwpNR2d4R2pBWUJnTlZCQU1NRVVsdWRHVnNJRk5IV0NCU2IyOTBJRU5CTVJvd0dBWURWUVFLREJGSmJuUmxiQ0JECmIzSndiM0poZEdsdmJqRVVNQklHQTFVRUJ3d0xVMkZ1ZEdFZ1EyeGhjbUV4Q3pBSkJnTlZCQWdNQWtOQk1Rc3cKQ1FZRFZRUUdFd0pWVXpBZUZ3MHhPREExTWpFeE1EVXdNVEJhRncwek16QTFNakV4TURVd01UQmFNSEF4SWpBZwpCZ05WQkFNTUdVbHVkR1ZzSUZOSFdDQlFRMHNnVUd4aGRHWnZjbTBnUTBFeEdqQVlCZ05WQkFvTUVVbHVkR1ZzCklFTnZjbkJ2Y21GMGFXOXVNUlF3RWdZRFZRUUhEQXRUWVc1MFlTQkRiR0Z5WVRFTE1Ba0dBMVVFQ0F3Q1EwRXgKQ3pBSkJnTlZCQVlUQWxWVE1Ga3dFd1lIS29aSXpqMENBUVlJS29aSXpqMERBUWNEUWdBRU5TQi83dDIxbFhTTwoyQ3V6cHh3NzRlSkI3MkV5REdnVzVyWEN0eDJ0VlRMcTZoS2s2eitVaVJaQ25xUjdwc092Z3FGZVN4bG1UbEpsCmVUbWkyV1l6M3FPQnV6Q0J1REFmQmdOVkhTTUVHREFXZ0JRaVpReldXcDAwaWZPRHRKVlN2MUFiT1NjR3JEQlMKQmdOVkhSOEVTekJKTUVlZ1JhQkRoa0ZvZEhSd2N6b3ZMMk5sY25ScFptbGpZWFJsY3k1MGNuVnpkR1ZrYzJWeQpkbWxqWlhNdWFXNTBaV3d1WTI5dEwwbHVkR1ZzVTBkWVVtOXZkRU5CTG1SbGNqQWRCZ05WSFE0RUZnUVVsVzlkCnpiMGI0ZWxBU2NuVTlEUE9BVmNMM2xRd0RnWURWUjBQQVFIL0JBUURBZ0VHTUJJR0ExVWRFd0VCL3dRSU1BWUIKQWY4Q0FRQXdDZ1lJS29aSXpqMEVBd0lEUndBd1JBSWdYc1ZraTB3K2k2VllHVzNVRi8yMnVhWGUwWUpEajFVZQpuQStUakQxYWk1Y0NJQ1liMVNBbUQ1eGtmVFZwdm80VW95aVNZeHJEV0xtVVI0Q0k5Tkt5ZlBOKwotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCi0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlDanpDQ0FqU2dBd0lCQWdJVUltVU0xbHFkTkluemc3U1ZVcjlRR3prbkJxd3dDZ1lJS29aSXpqMEVBd0l3CmFERWFNQmdHQTFVRUF3d1JTVzUwWld3Z1UwZFlJRkp2YjNRZ1EwRXhHakFZQmdOVkJBb01FVWx1ZEdWc0lFTnYKY25CdmNtRjBhVzl1TVJRd0VnWURWUVFIREF0VFlXNTBZU0JEYkdGeVlURUxNQWtHQTFVRUNBd0NRMEV4Q3pBSgpCZ05WQkFZVEFsVlRNQjRYRFRFNE1EVXlNVEV3TkRVeE1Gb1hEVFE1TVRJek1USXpOVGsxT1Zvd2FERWFNQmdHCkExVUVBd3dSU1c1MFpXd2dVMGRZSUZKdmIzUWdRMEV4R2pBWUJnTlZCQW9NRVVsdWRHVnNJRU52Y25CdmNtRjAKYVc5dU1SUXdFZ1lEVlFRSERBdFRZVzUwWVNCRGJHRnlZVEVMTUFrR0ExVUVDQXdDUTBFeEN6QUpCZ05WQkFZVApBbFZUTUZrd0V3WUhLb1pJemowQ0FRWUlLb1pJemowREFRY0RRZ0FFQzZuRXdNRElZWk9qL2lQV3NDemFFS2k3CjFPaU9TTFJGaFdHamJuQlZKZlZua1k0dTNJamtEWVlMME14TzRtcXN5WWpsQmFsVFZZeEZQMnNKQks1emxLT0IKdXpDQnVEQWZCZ05WSFNNRUdEQVdnQlFpWlF6V1dwMDBpZk9EdEpWU3YxQWJPU2NHckRCU0JnTlZIUjhFU3pCSgpNRWVnUmFCRGhrRm9kSFJ3Y3pvdkwyTmxjblJwWm1sallYUmxjeTUwY25WemRHVmtjMlZ5ZG1salpYTXVhVzUwClpXd3VZMjl0TDBsdWRHVnNVMGRZVW05dmRFTkJMbVJsY2pBZEJnTlZIUTRFRmdRVUltVU0xbHFkTkluemc3U1YKVXI5UUd6a25CcXd3RGdZRFZSMFBBUUgvQkFRREFnRUdNQklHQTFVZEV3RUIvd1FJTUFZQkFmOENBUUV3Q2dZSQpLb1pJemowRUF3SURTUUF3UmdJaEFPVy81UWtSK1M5Q2lTRGNOb293THVQUkxzV0dmL1lpN0dTWDk0Qmd3VHdnCkFpRUE0SjBsckhvTXMrWG81by9zWDZPOVFXeEhSQXZaVUdPZFJRN2N2cVJYYXFJPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCgA=`
	collateralJson := `{"major_version":1,"minor_version":0,"tee_type":0,"pck_crl_issuer_chain":[45,45,45,45,45,66,69,71,73,78,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,77,73,73,67,108,106,67,67,65,106,50,103,65,119,73,66,65,103,73,86,65,74,86,118,88,99,50,57,71,43,72,112,81,69,110,74,49,80,81,122,122,103,70,88,67,57,53,85,77,65,111,71,67,67,113,71,83,77,52,57,66,65,77,67,10,77,71,103,120,71,106,65,89,66,103,78,86,66,65,77,77,69,85,108,117,100,71,86,115,73,70,78,72,87,67,66,83,98,50,57,48,73,69,78,66,77,82,111,119,71,65,89,68,86,81,81,75,68,66,70,74,98,110,82,108,98,67,66,68,10,98,51,74,119,98,51,74,104,100,71,108,118,98,106,69,85,77,66,73,71,65,49,85,69,66,119,119,76,85,50,70,117,100,71,69,103,81,50,120,104,99,109,69,120,67,122,65,74,66,103,78,86,66,65,103,77,65,107,78,66,77,81,115,119,10,67,81,89,68,86,81,81,71,69,119,74,86,85,122,65,101,70,119,48,120,79,68,65,49,77,106,69,120,77,68,85,119,77,84,66,97,70,119,48,122,77,122,65,49,77,106,69,120,77,68,85,119,77,84,66,97,77,72,65,120,73,106,65,103,10,66,103,78,86,66,65,77,77,71,85,108,117,100,71,86,115,73,70,78,72,87,67,66,81,81,48,115,103,85,71,120,104,100,71,90,118,99,109,48,103,81,48,69,120,71,106,65,89,66,103,78,86,66,65,111,77,69,85,108,117,100,71,86,115,10,73,69,78,118,99,110,66,118,99,109,70,48,97,87,57,117,77,82,81,119,69,103,89,68,86,81,81,72,68,65,116,84,89,87,53,48,89,83,66,68,98,71,70,121,89,84,69,76,77,65,107,71,65,49,85,69,67,65,119,67,81,48,69,120,10,67,122,65,74,66,103,78,86,66,65,89,84,65,108,86,84,77,70,107,119,69,119,89,72,75,111,90,73,122,106,48,67,65,81,89,73,75,111,90,73,122,106,48,68,65,81,99,68,81,103,65,69,78,83,66,47,55,116,50,49,108,88,83,79,10,50,67,117,122,112,120,119,55,52,101,74,66,55,50,69,121,68,71,103,87,53,114,88,67,116,120,50,116,86,84,76,113,54,104,75,107,54,122,43,85,105,82,90,67,110,113,82,55,112,115,79,118,103,113,70,101,83,120,108,109,84,108,74,108,10,101,84,109,105,50,87,89,122,51,113,79,66,117,122,67,66,117,68,65,102,66,103,78,86,72,83,77,69,71,68,65,87,103,66,81,105,90,81,122,87,87,112,48,48,105,102,79,68,116,74,86,83,118,49,65,98,79,83,99,71,114,68,66,83,10,66,103,78,86,72,82,56,69,83,122,66,74,77,69,101,103,82,97,66,68,104,107,70,111,100,72,82,119,99,122,111,118,76,50,78,108,99,110,82,112,90,109,108,106,89,88,82,108,99,121,53,48,99,110,86,122,100,71,86,107,99,50,86,121,10,100,109,108,106,90,88,77,117,97,87,53,48,90,87,119,117,89,50,57,116,76,48,108,117,100,71,86,115,85,48,100,89,85,109,57,118,100,69,78,66,76,109,82,108,99,106,65,100,66,103,78,86,72,81,52,69,70,103,81,85,108,87,57,100,10,122,98,48,98,52,101,108,65,83,99,110,85,57,68,80,79,65,86,99,76,51,108,81,119,68,103,89,68,86,82,48,80,65,81,72,47,66,65,81,68,65,103,69,71,77,66,73,71,65,49,85,100,69,119,69,66,47,119,81,73,77,65,89,66,10,65,102,56,67,65,81,65,119,67,103,89,73,75,111,90,73,122,106,48,69,65,119,73,68,82,119,65,119,82,65,73,103,88,115,86,107,105,48,119,43,105,54,86,89,71,87,51,85,70,47,50,50,117,97,88,101,48,89,74,68,106,49,85,101,10,110,65,43,84,106,68,49,97,105,53,99,67,73,67,89,98,49,83,65,109,68,53,120,107,102,84,86,112,118,111,52,85,111,121,105,83,89,120,114,68,87,76,109,85,82,52,67,73,57,78,75,121,102,80,78,43,10,45,45,45,45,45,69,78,68,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,45,45,45,45,45,66,69,71,73,78,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,77,73,73,67,106,122,67,67,65,106,83,103,65,119,73,66,65,103,73,85,73,109,85,77,49,108,113,100,78,73,110,122,103,55,83,86,85,114,57,81,71,122,107,110,66,113,119,119,67,103,89,73,75,111,90,73,122,106,48,69,65,119,73,119,10,97,68,69,97,77,66,103,71,65,49,85,69,65,119,119,82,83,87,53,48,90,87,119,103,85,48,100,89,73,70,74,118,98,51,81,103,81,48,69,120,71,106,65,89,66,103,78,86,66,65,111,77,69,85,108,117,100,71,86,115,73,69,78,118,10,99,110,66,118,99,109,70,48,97,87,57,117,77,82,81,119,69,103,89,68,86,81,81,72,68,65,116,84,89,87,53,48,89,83,66,68,98,71,70,121,89,84,69,76,77,65,107,71,65,49,85,69,67,65,119,67,81,48,69,120,67,122,65,74,10,66,103,78,86,66,65,89,84,65,108,86,84,77,66,52,88,68,84,69,52,77,68,85,121,77,84,69,119,78,68,85,120,77,70,111,88,68,84,81,53,77,84,73,122,77,84,73,122,78,84,107,49,79,86,111,119,97,68,69,97,77,66,103,71,10,65,49,85,69,65,119,119,82,83,87,53,48,90,87,119,103,85,48,100,89,73,70,74,118,98,51,81,103,81,48,69,120,71,106,65,89,66,103,78,86,66,65,111,77,69,85,108,117,100,71,86,115,73,69,78,118,99,110,66,118,99,109,70,48,10,97,87,57,117,77,82,81,119,69,103,89,68,86,81,81,72,68,65,116,84,89,87,53,48,89,83,66,68,98,71,70,121,89,84,69,76,77,65,107,71,65,49,85,69,67,65,119,67,81,48,69,120,67,122,65,74,66,103,78,86,66,65,89,84,10,65,108,86,84,77,70,107,119,69,119,89,72,75,111,90,73,122,106,48,67,65,81,89,73,75,111,90,73,122,106,48,68,65,81,99,68,81,103,65,69,67,54,110,69,119,77,68,73,89,90,79,106,47,105,80,87,115,67,122,97,69,75,105,55,10,49,79,105,79,83,76,82,70,104,87,71,106,98,110,66,86,74,102,86,110,107,89,52,117,51,73,106,107,68,89,89,76,48,77,120,79,52,109,113,115,121,89,106,108,66,97,108,84,86,89,120,70,80,50,115,74,66,75,53,122,108,75,79,66,10,117,122,67,66,117,68,65,102,66,103,78,86,72,83,77,69,71,68,65,87,103,66,81,105,90,81,122,87,87,112,48,48,105,102,79,68,116,74,86,83,118,49,65,98,79,83,99,71,114,68,66,83,66,103,78,86,72,82,56,69,83,122,66,74,10,77,69,101,103,82,97,66,68,104,107,70,111,100,72,82,119,99,122,111,118,76,50,78,108,99,110,82,112,90,109,108,106,89,88,82,108,99,121,53,48,99,110,86,122,100,71,86,107,99,50,86,121,100,109,108,106,90,88,77,117,97,87,53,48,10,90,87,119,117,89,50,57,116,76,48,108,117,100,71,86,115,85,48,100,89,85,109,57,118,100,69,78,66,76,109,82,108,99,106,65,100,66,103,78,86,72,81,52,69,70,103,81,85,73,109,85,77,49,108,113,100,78,73,110,122,103,55,83,86,10,85,114,57,81,71,122,107,110,66,113,119,119,68,103,89,68,86,82,48,80,65,81,72,47,66,65,81,68,65,103,69,71,77,66,73,71,65,49,85,100,69,119,69,66,47,119,81,73,77,65,89,66,65,102,56,67,65,81,69,119,67,103,89,73,10,75,111,90,73,122,106,48,69,65,119,73,68,83,81,65,119,82,103,73,104,65,79,87,47,53,81,107,82,43,83,57,67,105,83,68,99,78,111,111,119,76,117,80,82,76,115,87,71,102,47,89,105,55,71,83,88,57,52,66,103,119,84,119,103,10,65,105,69,65,52,74,48,108,114,72,111,77,115,43,88,111,53,111,47,115,88,54,79,57,81,87,120,72,82,65,118,90,85,71,79,100,82,81,55,99,118,113,82,88,97,113,73,61,10,45,45,45,45,45,69,78,68,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,0],"root_ca_crl":[45,45,45,45,45,66,69,71,73,78,32,88,53,48,57,32,67,82,76,45,45,45,45,45,10,77,73,73,66,73,84,67,66,121,65,73,66,65,84,65,75,66,103,103,113,104,107,106,79,80,81,81,68,65,106,66,111,77,82,111,119,71,65,89,68,86,81,81,68,68,66,70,74,98,110,82,108,98,67,66,84,82,49,103,103,85,109,57,118,10,100,67,66,68,81,84,69,97,77,66,103,71,65,49,85,69,67,103,119,82,83,87,53,48,90,87,119,103,81,50,57,121,99,71,57,121,89,88,82,112,98,50,52,120,70,68,65,83,66,103,78,86,66,65,99,77,67,49,78,104,98,110,82,104,10,73,69,78,115,89,88,74,104,77,81,115,119,67,81,89,68,86,81,81,73,68,65,74,68,81,84,69,76,77,65,107,71,65,49,85,69,66,104,77,67,86,86,77,88,68,84,73,122,77,68,81,119,77,122,69,119,77,106,73,49,77,86,111,88,10,68,84,73,48,77,68,81,119,77,106,69,119,77,106,73,49,77,86,113,103,76,122,65,116,77,65,111,71,65,49,85,100,70,65,81,68,65,103,69,66,77,66,56,71,65,49,85,100,73,119,81,89,77,66,97,65,70,67,74,108,68,78,90,97,10,110,84,83,74,56,52,79,48,108,86,75,47,85,66,115,53,74,119,97,115,77,65,111,71,67,67,113,71,83,77,52,57,66,65,77,67,65,48,103,65,77,69,85,67,73,70,70,88,102,85,102,90,43,54,70,88,116,108,56,101,116,102,82,108,10,101,55,120,101,86,115,121,118,99,49,111,68,56,98,108,106,49,119,83,65,87,114,69,89,65,105,69,65,107,53,65,86,55,66,89,50,53,43,114,54,88,48,74,115,72,107,65,109,82,56,90,122,69,121,116,111,85,77,113,57,97,77,55,50,10,117,116,100,111,75,103,77,61,10,45,45,45,45,45,69,78,68,32,88,53,48,57,32,67,82,76,45,45,45,45,45,10,0],"pck_crl":[45,45,45,45,45,66,69,71,73,78,32,88,53,48,57,32,67,82,76,45,45,45,45,45,10,77,73,73,75,89,84,67,67,67,103,103,67,65,81,69,119,67,103,89,73,75,111,90,73,122,106,48,69,65,119,73,119,99,68,69,105,77,67,65,71,65,49,85,69,65,119,119,90,83,87,53,48,90,87,119,103,85,48,100,89,73,70,66,68,10,83,121,66,81,98,71,70,48,90,109,57,121,98,83,66,68,81,84,69,97,77,66,103,71,65,49,85,69,67,103,119,82,83,87,53,48,90,87,119,103,81,50,57,121,99,71,57,121,89,88,82,112,98,50,52,120,70,68,65,83,66,103,78,86,10,66,65,99,77,67,49,78,104,98,110,82,104,73,69,78,115,89,88,74,104,77,81,115,119,67,81,89,68,86,81,81,73,68,65,74,68,81,84,69,76,77,65,107,71,65,49,85,69,66,104,77,67,86,86,77,88,68,84,73,122,77,68,85,120,10,77,122,73,120,77,68,65,119,77,49,111,88,68,84,73,122,77,68,89,120,77,106,73,120,77,68,65,119,77,49,111,119,103,103,107,48,77,68,77,67,70,71,47,68,84,108,65,106,53,121,105,83,78,68,88,87,71,113,83,52,80,71,71,66,10,90,113,48,49,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,65,81,69,119,78,65,73,86,65,79,43,117,98,112,99,86,47,75,69,55,104,43,77,122,10,54,67,89,101,49,116,109,81,113,83,97,116,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,65,81,69,119,78,65,73,86,65,80,49,103,104,107,104,105,10,110,76,112,122,66,52,116,78,83,83,57,76,80,113,100,66,114,81,106,78,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,65,81,69,119,78,65,73,86,10,65,73,114,53,74,66,104,79,72,86,114,57,51,88,80,68,49,106,111,83,57,101,105,49,99,51,53,87,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,10,65,81,69,119,78,65,73,86,65,76,69,108,101,88,106,80,113,99,122,100,66,49,109,114,43,77,88,75,99,118,114,106,112,52,113,98,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,10,86,82,48,86,66,65,77,75,65,81,69,119,77,119,73,85,100,80,54,109,70,75,108,121,118,103,52,111,81,47,73,70,109,68,87,66,72,116,104,121,43,98,77,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,10,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,48,65,104,85,65,43,99,84,118,86,114,79,114,83,78,86,51,52,81,105,54,55,102,83,47,105,65,70,67,70,76,107,88,68,84,73,122,77,68,85,120,77,122,73,120,10,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,122,65,104,81,72,72,101,66,51,106,53,53,102,120,80,75,72,106,122,68,87,115,72,121,97,77,79,97,122,67,120,99,78,77,106,77,119,10,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,81,67,70,81,68,78,52,107,74,80,108,121,122,113,108,80,56,106,109,84,102,48,50,65,119,108,65,112,51,87,10,67,120,99,78,77,106,77,119,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,77,67,70,71,119,122,71,101,85,81,109,50,82,81,102,84,122,120,69,121,122,103,10,65,48,110,118,85,110,77,90,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,65,81,69,119,78,65,73,86,65,78,56,73,49,49,97,50,97,110,83,88,10,57,68,116,98,116,89,114,97,66,78,80,48,57,54,107,51,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,65,81,69,119,77,119,73,85,75,75,57,73,10,87,50,122,50,102,107,67,97,79,100,88,76,87,117,53,70,109,80,101,111,43,110,115,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,48,10,65,104,85,65,43,52,115,116,114,115,67,83,121,116,113,75,113,98,120,80,56,118,72,67,68,81,78,71,90,111,119,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,10,65,119,111,66,65,84,65,48,65,104,85,65,122,85,104,81,114,70,75,57,122,71,109,109,112,118,66,89,121,76,120,88,117,57,67,49,43,71,81,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,10,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,48,65,104,85,65,109,85,51,84,90,109,57,83,100,102,117,65,88,53,88,100,65,114,49,81,121,121,90,53,50,75,48,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,10,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,122,65,104,81,72,65,104,78,112,65,67,85,105,100,78,107,68,88,117,51,49,82,88,82,105,43,116,68,118,84,66,99,78,77,106,77,119,78,84,69,122,10,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,77,67,70,71,72,121,118,51,80,106,109,48,52,69,113,105,102,89,65,98,49,122,48,107,77,90,116,98,43,65,70,119,48,121,10,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,65,81,69,119,77,119,73,85,79,90,75,43,104,82,117,87,107,67,55,47,79,74,87,101,98,67,55,47,71,119,90,82,10,112,76,85,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,122,65,104,82,106,110,120,79,97,85,69,68,57,122,47,71,82,54,75,84,55,10,71,47,67,71,55,87,65,53,99,82,99,78,77,106,77,119,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,81,67,70,81,67,86,110,86,77,47,107,107,110,99,10,72,108,69,49,82,77,51,73,77,76,56,90,116,47,72,122,65,82,99,78,77,106,77,119,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,77,67,70,65,47,97,10,81,54,65,76,97,79,112,53,116,56,76,101,114,113,119,76,83,89,118,102,115,113,43,81,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,65,81,69,119,10,78,65,73,86,65,74,49,110,100,84,117,66,53,72,67,81,114,113,100,106,43,43,120,77,82,85,109,56,50,53,107,122,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,10,66,65,77,75,65,81,69,119,77,119,73,85,78,76,43,55,101,104,50,99,86,111,70,72,52,82,105,50,70,80,101,51,98,116,80,118,97,78,56,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,10,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,48,65,104,85,65,104,100,80,74,79,66,116,51,112,43,66,78,69,90,121,101,87,116,90,48,110,47,80,47,113,52,99,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,10,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,48,65,104,85,65,107,52,104,56,112,69,69,101,101,112,73,55,48,102,55,83,103,90,115,112,83,102,73,66,116,98,81,88,68,84,73,122,77,68,85,120,10,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,122,65,104,81,107,109,78,120,105,103,53,77,74,108,118,50,76,56,106,111,51,114,76,52,109,111,55,55,85,86,120,99,78,10,77,106,77,119,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,81,67,70,81,67,75,90,118,71,110,83,85,105,71,90,50,105,99,119,53,65,54,120,85,120,109,10,75,51,69,117,99,120,99,78,77,106,77,119,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,81,67,70,81,67,118,119,84,89,81,118,100,78,115,116,53,104,100,10,69,71,83,66,113,73,68,84,111,66,47,97,66,120,99,78,77,106,77,119,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,81,67,70,81,68,118,52,69,115,115,10,77,57,65,50,113,115,108,115,112,110,79,47,72,112,112,72,116,107,49,99,117,120,99,78,77,106,77,119,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,81,67,10,70,81,67,68,50,97,121,78,105,55,85,74,48,99,98,73,67,97,49,120,76,111,81,119,86,90,55,88,56,120,99,78,77,106,77,119,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,10,67,103,69,66,77,68,77,67,70,72,107,120,47,86,67,49,66,120,119,98,118,56,87,51,116,116,55,89,116,70,117,100,105,52,85,112,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,10,86,82,48,86,66,65,77,75,65,81,69,119,77,119,73,85,72,54,73,79,75,88,67,57,53,100,86,47,101,52,51,102,103,122,108,73,84,104,56,100,67,67,77,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,10,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,122,65,104,81,101,104,55,76,68,115,121,50,78,73,43,81,82,122,118,78,66,108,55,108,97,56,77,105,116,57,82,99,78,77,106,77,119,78,84,69,122,77,106,69,119,10,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,81,67,70,81,67,97,47,83,55,112,67,107,99,49,85,75,70,110,50,90,97,82,70,68,102,72,85,67,48,102,67,82,99,78,77,106,77,119,10,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,77,67,70,69,83,66,115,80,69,88,75,75,69,55,97,87,48,43,113,99,100,119,111,76,70,101,120,89,51,97,10,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,65,81,69,119,78,65,73,86,65,75,101,70,110,49,101,89,76,118,68,109,102,84,101,56,106,118,76,118,10,87,115,103,49,47,120,113,112,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,65,81,69,119,77,119,73,85,101,117,78,51,83,75,110,53,69,118,84,71,10,79,54,101,114,66,56,87,84,122,104,48,100,69,89,69,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,122,65,104,81,84,105,69,115,122,10,74,112,107,52,119,90,87,113,70,119,47,75,100,100,111,88,100,84,106,102,67,120,99,78,77,106,77,119,78,84,69,122,77,106,69,119,77,68,65,122,87,106,65,77,77,65,111,71,65,49,85,100,70,81,81,68,67,103,69,66,77,68,77,67,10,70,67,119,56,120,118,54,83,101,100,115,86,70,116,88,79,79,102,75,111,109,77,50,108,111,88,88,104,70,119,48,121,77,122,65,49,77,84,77,121,77,84,65,119,77,68,78,97,77,65,119,119,67,103,89,68,86,82,48,86,66,65,77,75,10,65,81,69,119,77,119,73,85,99,88,108,73,97,72,85,74,73,48,118,112,101,101,83,51,51,79,98,122,71,43,57,107,116,111,119,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,10,72,82,85,69,65,119,111,66,65,84,65,48,65,104,85,65,110,88,98,118,76,68,110,66,78,117,104,108,105,50,53,122,108,114,72,88,82,70,111,110,89,120,56,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,10,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,48,65,104,85,65,119,43,65,108,47,75,109,86,56,50,57,90,116,73,82,110,107,53,52,43,78,79,89,50,71,109,56,88,68,84,73,122,77,68,85,120,77,122,73,120,10,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,48,65,104,85,65,106,70,57,114,77,108,102,97,66,98,70,48,75,101,76,109,71,54,108,108,49,110,77,119,89,71,111,88,68,84,73,122,10,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,84,65,48,65,104,85,65,111,88,120,82,99,105,55,66,52,77,77,110,106,43,105,57,56,70,73,70,110,76,55,69,10,53,107,103,88,68,84,73,122,77,68,85,120,77,122,73,120,77,68,65,119,77,49,111,119,68,68,65,75,66,103,78,86,72,82,85,69,65,119,111,66,65,97,65,118,77,67,48,119,67,103,89,68,86,82,48,85,66,65,77,67,65,81,69,119,10,72,119,89,68,86,82,48,106,66,66,103,119,70,111,65,85,108,87,57,100,122,98,48,98,52,101,108,65,83,99,110,85,57,68,80,79,65,86,99,76,51,108,81,119,67,103,89,73,75,111,90,73,122,106,48,69,65,119,73,68,82,119,65,119,10,82,65,73,103,70,67,99,69,120,104,99,57,109,117,90,67,74,121,98,69,103,97,68,116,103,72,49,90,70,53,115,55,51,57,73,72,84,106,88,108,47,74,90,84,68,82,52,67,73,71,53,87,101,76,99,70,67,103,50,110,90,111,122,80,10,53,78,113,67,48,43,77,101,99,109,89,120,80,78,48,101,117,98,80,98,112,122,104,115,70,50,56,122,10,45,45,45,45,45,69,78,68,32,88,53,48,57,32,67,82,76,45,45,45,45,45,10,0],"tcb_info_issuer_chain":[45,45,45,45,45,66,69,71,73,78,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,77,73,73,67,105,122,67,67,65,106,75,103,65,119,73,66,65,103,73,85,102,106,105,67,49,102,116,86,75,85,112,65,83,89,53,70,104,65,80,112,70,74,71,57,57,70,85,119,67,103,89,73,75,111,90,73,122,106,48,69,65,119,73,119,10,97,68,69,97,77,66,103,71,65,49,85,69,65,119,119,82,83,87,53,48,90,87,119,103,85,48,100,89,73,70,74,118,98,51,81,103,81,48,69,120,71,106,65,89,66,103,78,86,66,65,111,77,69,85,108,117,100,71,86,115,73,69,78,118,10,99,110,66,118,99,109,70,48,97,87,57,117,77,82,81,119,69,103,89,68,86,81,81,72,68,65,116,84,89,87,53,48,89,83,66,68,98,71,70,121,89,84,69,76,77,65,107,71,65,49,85,69,67,65,119,67,81,48,69,120,67,122,65,74,10,66,103,78,86,66,65,89,84,65,108,86,84,77,66,52,88,68,84,69,52,77,68,85,121,77,84,69,119,78,84,65,120,77,70,111,88,68,84,73,49,77,68,85,121,77,84,69,119,78,84,65,120,77,70,111,119,98,68,69,101,77,66,119,71,10,65,49,85,69,65,119,119,86,83,87,53,48,90,87,119,103,85,48,100,89,73,70,82,68,81,105,66,84,97,87,100,117,97,87,53,110,77,82,111,119,71,65,89,68,86,81,81,75,68,66,70,74,98,110,82,108,98,67,66,68,98,51,74,119,10,98,51,74,104,100,71,108,118,98,106,69,85,77,66,73,71,65,49,85,69,66,119,119,76,85,50,70,117,100,71,69,103,81,50,120,104,99,109,69,120,67,122,65,74,66,103,78,86,66,65,103,77,65,107,78,66,77,81,115,119,67,81,89,68,10,86,81,81,71,69,119,74,86,85,122,66,90,77,66,77,71,66,121,113,71,83,77,52,57,65,103,69,71,67,67,113,71,83,77,52,57,65,119,69,72,65,48,73,65,66,69,78,70,71,56,120,122,121,100,87,82,102,75,57,50,98,109,71,118,10,80,43,109,65,104,57,49,80,69,121,86,55,74,104,54,70,71,74,100,53,110,100,69,57,97,66,72,55,82,51,69,52,65,55,117,98,114,108,104,47,122,78,51,67,52,120,118,112,111,111,117,71,108,105,114,77,98,97,43,87,50,108,106,117,10,121,112,97,106,103,98,85,119,103,98,73,119,72,119,89,68,86,82,48,106,66,66,103,119,70,111,65,85,73,109,85,77,49,108,113,100,78,73,110,122,103,55,83,86,85,114,57,81,71,122,107,110,66,113,119,119,85,103,89,68,86,82,48,102,10,66,69,115,119,83,84,66,72,111,69,87,103,81,52,90,66,97,72,82,48,99,72,77,54,76,121,57,106,90,88,74,48,97,87,90,112,89,50,70,48,90,88,77,117,100,72,74,49,99,51,82,108,90,72,78,108,99,110,90,112,89,50,86,122,10,76,109,108,117,100,71,86,115,76,109,78,118,98,83,57,74,98,110,82,108,98,70,78,72,87,70,74,118,98,51,82,68,81,83,53,107,90,88,73,119,72,81,89,68,86,82,48,79,66,66,89,69,70,72,52,52,103,116,88,55,86,83,108,75,10,81,69,109,79,82,89,81,68,54,82,83,82,118,102,82,86,77,65,52,71,65,49,85,100,68,119,69,66,47,119,81,69,65,119,73,71,119,68,65,77,66,103,78,86,72,82,77,66,65,102,56,69,65,106,65,65,77,65,111,71,67,67,113,71,10,83,77,52,57,66,65,77,67,65,48,99,65,77,69,81,67,73,66,57,67,56,119,79,65,78,47,73,109,120,68,116,71,65,67,86,50,52,54,75,99,113,106,97,103,90,79,82,48,107,121,99,116,121,66,114,115,71,71,74,86,65,105,65,106,10,102,116,98,114,78,71,115,71,85,56,89,72,50,49,49,100,82,105,89,78,111,80,80,117,49,57,90,112,47,122,101,56,74,109,104,117,106,66,48,111,66,119,61,61,10,45,45,45,45,45,69,78,68,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,45,45,45,45,45,66,69,71,73,78,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,77,73,73,67,106,122,67,67,65,106,83,103,65,119,73,66,65,103,73,85,73,109,85,77,49,108,113,100,78,73,110,122,103,55,83,86,85,114,57,81,71,122,107,110,66,113,119,119,67,103,89,73,75,111,90,73,122,106,48,69,65,119,73,119,10,97,68,69,97,77,66,103,71,65,49,85,69,65,119,119,82,83,87,53,48,90,87,119,103,85,48,100,89,73,70,74,118,98,51,81,103,81,48,69,120,71,106,65,89,66,103,78,86,66,65,111,77,69,85,108,117,100,71,86,115,73,69,78,118,10,99,110,66,118,99,109,70,48,97,87,57,117,77,82,81,119,69,103,89,68,86,81,81,72,68,65,116,84,89,87,53,48,89,83,66,68,98,71,70,121,89,84,69,76,77,65,107,71,65,49,85,69,67,65,119,67,81,48,69,120,67,122,65,74,10,66,103,78,86,66,65,89,84,65,108,86,84,77,66,52,88,68,84,69,52,77,68,85,121,77,84,69,119,78,68,85,120,77,70,111,88,68,84,81,53,77,84,73,122,77,84,73,122,78,84,107,49,79,86,111,119,97,68,69,97,77,66,103,71,10,65,49,85,69,65,119,119,82,83,87,53,48,90,87,119,103,85,48,100,89,73,70,74,118,98,51,81,103,81,48,69,120,71,106,65,89,66,103,78,86,66,65,111,77,69,85,108,117,100,71,86,115,73,69,78,118,99,110,66,118,99,109,70,48,10,97,87,57,117,77,82,81,119,69,103,89,68,86,81,81,72,68,65,116,84,89,87,53,48,89,83,66,68,98,71,70,121,89,84,69,76,77,65,107,71,65,49,85,69,67,65,119,67,81,48,69,120,67,122,65,74,66,103,78,86,66,65,89,84,10,65,108,86,84,77,70,107,119,69,119,89,72,75,111,90,73,122,106,48,67,65,81,89,73,75,111,90,73,122,106,48,68,65,81,99,68,81,103,65,69,67,54,110,69,119,77,68,73,89,90,79,106,47,105,80,87,115,67,122,97,69,75,105,55,10,49,79,105,79,83,76,82,70,104,87,71,106,98,110,66,86,74,102,86,110,107,89,52,117,51,73,106,107,68,89,89,76,48,77,120,79,52,109,113,115,121,89,106,108,66,97,108,84,86,89,120,70,80,50,115,74,66,75,53,122,108,75,79,66,10,117,122,67,66,117,68,65,102,66,103,78,86,72,83,77,69,71,68,65,87,103,66,81,105,90,81,122,87,87,112,48,48,105,102,79,68,116,74,86,83,118,49,65,98,79,83,99,71,114,68,66,83,66,103,78,86,72,82,56,69,83,122,66,74,10,77,69,101,103,82,97,66,68,104,107,70,111,100,72,82,119,99,122,111,118,76,50,78,108,99,110,82,112,90,109,108,106,89,88,82,108,99,121,53,48,99,110,86,122,100,71,86,107,99,50,86,121,100,109,108,106,90,88,77,117,97,87,53,48,10,90,87,119,117,89,50,57,116,76,48,108,117,100,71,86,115,85,48,100,89,85,109,57,118,100,69,78,66,76,109,82,108,99,106,65,100,66,103,78,86,72,81,52,69,70,103,81,85,73,109,85,77,49,108,113,100,78,73,110,122,103,55,83,86,10,85,114,57,81,71,122,107,110,66,113,119,119,68,103,89,68,86,82,48,80,65,81,72,47,66,65,81,68,65,103,69,71,77,66,73,71,65,49,85,100,69,119,69,66,47,119,81,73,77,65,89,66,65,102,56,67,65,81,69,119,67,103,89,73,10,75,111,90,73,122,106,48,69,65,119,73,68,83,81,65,119,82,103,73,104,65,79,87,47,53,81,107,82,43,83,57,67,105,83,68,99,78,111,111,119,76,117,80,82,76,115,87,71,102,47,89,105,55,71,83,88,57,52,66,103,119,84,119,103,10,65,105,69,65,52,74,48,108,114,72,111,77,115,43,88,111,53,111,47,115,88,54,79,57,81,87,120,72,82,65,118,90,85,71,79,100,82,81,55,99,118,113,82,88,97,113,73,61,10,45,45,45,45,45,69,78,68,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,0],"tcb_info":[123,34,116,99,98,73,110,102,111,34,58,123,34,105,100,34,58,34,83,71,88,34,44,34,118,101,114,115,105,111,110,34,58,51,44,34,105,115,115,117,101,68,97,116,101,34,58,34,50,48,50,51,45,48,53,45,49,53,84,49,52,58,48,56,58,49,49,90,34,44,34,110,101,120,116,85,112,100,97,116,101,34,58,34,50,48,50,51,45,48,54,45,49,52,84,49,52,58,48,56,58,49,49,90,34,44,34,102,109,115,112,99,34,58,34,48,48,54,48,54,97,48,48,48,48,48,48,34,44,34,112,99,101,73,100,34,58,34,48,48,48,48,34,44,34,116,99,98,84,121,112,101,34,58,48,44,34,116,99,98,69,118,97,108,117,97,116,105,111,110,68,97,116,97,78,117,109,98,101,114,34,58,49,53,44,34,116,99,98,76,101,118,101,108,115,34,58,91,123,34,116,99,98,34,58,123,34,115,103,120,116,99,98,99,111,109,112,111,110,101,110,116,115,34,58,91,123,34,115,118,110,34,58,49,49,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,44,34,116,121,112,101,34,58,34,69,97,114,108,121,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,49,49,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,83,71,88,32,76,97,116,101,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,84,88,84,32,83,73,78,73,84,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,49,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,93,44,34,112,99,101,115,118,110,34,58,49,51,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,50,51,45,48,50,45,49,53,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,83,87,72,97,114,100,101,110,105,110,103,78,101,101,100,101,100,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,93,125,44,123,34,116,99,98,34,58,123,34,115,103,120,116,99,98,99,111,109,112,111,110,101,110,116,115,34,58,91,123,34,115,118,110,34,58,49,49,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,44,34,116,121,112,101,34,58,34,69,97,114,108,121,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,49,49,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,83,71,88,32,76,97,116,101,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,84,88,84,32,83,73,78,73,84,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,93,44,34,112,99,101,115,118,110,34,58,49,51,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,50,51,45,48,50,45,49,53,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,67,111,110,102,105,103,117,114,97,116,105,111,110,65,110,100,83,87,72,97,114,100,101,110,105,110,103,78,101,101,100,101,100,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,93,125,44,123,34,116,99,98,34,58,123,34,115,103,120,116,99,98,99,111,109,112,111,110,101,110,116,115,34,58,91,123,34,115,118,110,34,58,55,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,44,34,116,121,112,101,34,58,34,69,97,114,108,121,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,57,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,83,71,88,32,76,97,116,101,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,84,88,84,32,83,73,78,73,84,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,49,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,93,44,34,112,99,101,115,118,110,34,58,49,51,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,50,50,45,48,56,45,49,48,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,54,53,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,48,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,56,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,54,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,93,125,44,123,34,116,99,98,34,58,123,34,115,103,120,116,99,98,99,111,109,112,111,110,101,110,116,115,34,58,91,123,34,115,118,110,34,58,55,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,44,34,116,121,112,101,34,58,34,69,97,114,108,121,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,57,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,83,71,88,32,76,97,116,101,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,84,88,84,32,83,73,78,73,84,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,93,44,34,112,99,101,115,118,110,34,58,49,51,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,50,50,45,48,56,45,49,48,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,67,111,110,102,105,103,117,114,97,116,105,111,110,78,101,101,100,101,100,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,54,53,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,48,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,56,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,54,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,93,125,44,123,34,116,99,98,34,58,123,34,115,103,120,116,99,98,99,111,109,112,111,110,101,110,116,115,34,58,91,123,34,115,118,110,34,58,52,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,44,34,116,121,112,101,34,58,34,69,97,114,108,121,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,52,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,83,71,88,32,76,97,116,101,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,84,88,84,32,83,73,78,73,84,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,93,44,34,112,99,101,115,118,110,34,58,49,49,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,50,49,45,49,49,45,49,48,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,53,56,54,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,52,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,53,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,48,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,56,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,54,55,34,93,125,44,123,34,116,99,98,34,58,123,34,115,103,120,116,99,98,99,111,109,112,111,110,101,110,116,115,34,58,91,123,34,115,118,110,34,58,52,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,44,34,116,121,112,101,34,58,34,69,97,114,108,121,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,52,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,83,71,88,32,76,97,116,101,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,84,88,84,32,83,73,78,73,84,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,93,44,34,112,99,101,115,118,110,34,58,49,48,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,50,48,45,49,49,45,49,49,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,52,55,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,53,56,54,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,52,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,53,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,48,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,56,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,54,55,34,93,125,44,123,34,116,99,98,34,58,123,34,115,103,120,116,99,98,99,111,109,112,111,110,101,110,116,115,34,58,91,123,34,115,118,110,34,58,52,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,44,34,116,121,112,101,34,58,34,69,97,114,108,121,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,52,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,83,71,88,32,76,97,116,101,32,77,105,99,114,111,99,111,100,101,32,85,112,100,97,116,101,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,79,83,47,86,77,77,34,44,34,116,121,112,101,34,58,34,84,88,84,32,83,73,78,73,84,34,125,44,123,34,115,118,110,34,58,51,44,34,99,97,116,101,103,111,114,121,34,58,34,66,73,79,83,34,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,50,53,53,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,44,123,34,115,118,110,34,58,48,125,93,44,34,112,99,101,115,118,110,34,58,53,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,49,56,45,48,49,45,48,52,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,49,48,54,34,44,34,73,78,84,69,76,45,83,65,45,48,48,49,49,53,34,44,34,73,78,84,69,76,45,83,65,45,48,48,49,51,53,34,44,34,73,78,84,69,76,45,83,65,45,48,48,50,48,51,34,44,34,73,78,84,69,76,45,83,65,45,48,48,50,50,48,34,44,34,73,78,84,69,76,45,83,65,45,48,48,50,51,51,34,44,34,73,78,84,69,76,45,83,65,45,48,48,50,55,48,34,44,34,73,78,84,69,76,45,83,65,45,48,48,50,57,51,34,44,34,73,78,84,69,76,45,83,65,45,48,48,51,50,48,34,44,34,73,78,84,69,76,45,83,65,45,48,48,51,50,57,34,44,34,73,78,84,69,76,45,83,65,45,48,48,51,56,49,34,44,34,73,78,84,69,76,45,83,65,45,48,48,51,56,57,34,44,34,73,78,84,69,76,45,83,65,45,48,48,52,55,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,53,56,54,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,52,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,53,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,48,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,51,56,34,44,34,73,78,84,69,76,45,83,65,45,48,48,55,54,55,34,93,125,93,125,44,34,115,105,103,110,97,116,117,114,101,34,58,34,53,102,101,101,55,53,54,56,52,55,49,56,98,99,98,57,49,57,49,51,49,50,99,100,51,98,102,52,55,48,57,54,97,52,48,54,56,102,52,53,48,100,50,101,99,57,101,48,53,98,56,99,100,53,97,51,97,55,99,98,54,49,98,50,57,50,54,49,50,97,55,48,56,99,52,99,53,97,51,48,52,56,51,54,99,56,50,99,51,97,55,49,57,49,52,52,55,101,51,98,97,54,57,49,101,53,57,50,56,55,99,99,57,99,56,57,52,51,101,56,50,49,55,51,52,100,52,49,34,125,0],"qe_identity_issuer_chain":[45,45,45,45,45,66,69,71,73,78,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,77,73,73,67,105,122,67,67,65,106,75,103,65,119,73,66,65,103,73,85,102,106,105,67,49,102,116,86,75,85,112,65,83,89,53,70,104,65,80,112,70,74,71,57,57,70,85,119,67,103,89,73,75,111,90,73,122,106,48,69,65,119,73,119,10,97,68,69,97,77,66,103,71,65,49,85,69,65,119,119,82,83,87,53,48,90,87,119,103,85,48,100,89,73,70,74,118,98,51,81,103,81,48,69,120,71,106,65,89,66,103,78,86,66,65,111,77,69,85,108,117,100,71,86,115,73,69,78,118,10,99,110,66,118,99,109,70,48,97,87,57,117,77,82,81,119,69,103,89,68,86,81,81,72,68,65,116,84,89,87,53,48,89,83,66,68,98,71,70,121,89,84,69,76,77,65,107,71,65,49,85,69,67,65,119,67,81,48,69,120,67,122,65,74,10,66,103,78,86,66,65,89,84,65,108,86,84,77,66,52,88,68,84,69,52,77,68,85,121,77,84,69,119,78,84,65,120,77,70,111,88,68,84,73,49,77,68,85,121,77,84,69,119,78,84,65,120,77,70,111,119,98,68,69,101,77,66,119,71,10,65,49,85,69,65,119,119,86,83,87,53,48,90,87,119,103,85,48,100,89,73,70,82,68,81,105,66,84,97,87,100,117,97,87,53,110,77,82,111,119,71,65,89,68,86,81,81,75,68,66,70,74,98,110,82,108,98,67,66,68,98,51,74,119,10,98,51,74,104,100,71,108,118,98,106,69,85,77,66,73,71,65,49,85,69,66,119,119,76,85,50,70,117,100,71,69,103,81,50,120,104,99,109,69,120,67,122,65,74,66,103,78,86,66,65,103,77,65,107,78,66,77,81,115,119,67,81,89,68,10,86,81,81,71,69,119,74,86,85,122,66,90,77,66,77,71,66,121,113,71,83,77,52,57,65,103,69,71,67,67,113,71,83,77,52,57,65,119,69,72,65,48,73,65,66,69,78,70,71,56,120,122,121,100,87,82,102,75,57,50,98,109,71,118,10,80,43,109,65,104,57,49,80,69,121,86,55,74,104,54,70,71,74,100,53,110,100,69,57,97,66,72,55,82,51,69,52,65,55,117,98,114,108,104,47,122,78,51,67,52,120,118,112,111,111,117,71,108,105,114,77,98,97,43,87,50,108,106,117,10,121,112,97,106,103,98,85,119,103,98,73,119,72,119,89,68,86,82,48,106,66,66,103,119,70,111,65,85,73,109,85,77,49,108,113,100,78,73,110,122,103,55,83,86,85,114,57,81,71,122,107,110,66,113,119,119,85,103,89,68,86,82,48,102,10,66,69,115,119,83,84,66,72,111,69,87,103,81,52,90,66,97,72,82,48,99,72,77,54,76,121,57,106,90,88,74,48,97,87,90,112,89,50,70,48,90,88,77,117,100,72,74,49,99,51,82,108,90,72,78,108,99,110,90,112,89,50,86,122,10,76,109,108,117,100,71,86,115,76,109,78,118,98,83,57,74,98,110,82,108,98,70,78,72,87,70,74,118,98,51,82,68,81,83,53,107,90,88,73,119,72,81,89,68,86,82,48,79,66,66,89,69,70,72,52,52,103,116,88,55,86,83,108,75,10,81,69,109,79,82,89,81,68,54,82,83,82,118,102,82,86,77,65,52,71,65,49,85,100,68,119,69,66,47,119,81,69,65,119,73,71,119,68,65,77,66,103,78,86,72,82,77,66,65,102,56,69,65,106,65,65,77,65,111,71,67,67,113,71,10,83,77,52,57,66,65,77,67,65,48,99,65,77,69,81,67,73,66,57,67,56,119,79,65,78,47,73,109,120,68,116,71,65,67,86,50,52,54,75,99,113,106,97,103,90,79,82,48,107,121,99,116,121,66,114,115,71,71,74,86,65,105,65,106,10,102,116,98,114,78,71,115,71,85,56,89,72,50,49,49,100,82,105,89,78,111,80,80,117,49,57,90,112,47,122,101,56,74,109,104,117,106,66,48,111,66,119,61,61,10,45,45,45,45,45,69,78,68,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,45,45,45,45,45,66,69,71,73,78,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,77,73,73,67,106,122,67,67,65,106,83,103,65,119,73,66,65,103,73,85,73,109,85,77,49,108,113,100,78,73,110,122,103,55,83,86,85,114,57,81,71,122,107,110,66,113,119,119,67,103,89,73,75,111,90,73,122,106,48,69,65,119,73,119,10,97,68,69,97,77,66,103,71,65,49,85,69,65,119,119,82,83,87,53,48,90,87,119,103,85,48,100,89,73,70,74,118,98,51,81,103,81,48,69,120,71,106,65,89,66,103,78,86,66,65,111,77,69,85,108,117,100,71,86,115,73,69,78,118,10,99,110,66,118,99,109,70,48,97,87,57,117,77,82,81,119,69,103,89,68,86,81,81,72,68,65,116,84,89,87,53,48,89,83,66,68,98,71,70,121,89,84,69,76,77,65,107,71,65,49,85,69,67,65,119,67,81,48,69,120,67,122,65,74,10,66,103,78,86,66,65,89,84,65,108,86,84,77,66,52,88,68,84,69,52,77,68,85,121,77,84,69,119,78,68,85,120,77,70,111,88,68,84,81,53,77,84,73,122,77,84,73,122,78,84,107,49,79,86,111,119,97,68,69,97,77,66,103,71,10,65,49,85,69,65,119,119,82,83,87,53,48,90,87,119,103,85,48,100,89,73,70,74,118,98,51,81,103,81,48,69,120,71,106,65,89,66,103,78,86,66,65,111,77,69,85,108,117,100,71,86,115,73,69,78,118,99,110,66,118,99,109,70,48,10,97,87,57,117,77,82,81,119,69,103,89,68,86,81,81,72,68,65,116,84,89,87,53,48,89,83,66,68,98,71,70,121,89,84,69,76,77,65,107,71,65,49,85,69,67,65,119,67,81,48,69,120,67,122,65,74,66,103,78,86,66,65,89,84,10,65,108,86,84,77,70,107,119,69,119,89,72,75,111,90,73,122,106,48,67,65,81,89,73,75,111,90,73,122,106,48,68,65,81,99,68,81,103,65,69,67,54,110,69,119,77,68,73,89,90,79,106,47,105,80,87,115,67,122,97,69,75,105,55,10,49,79,105,79,83,76,82,70,104,87,71,106,98,110,66,86,74,102,86,110,107,89,52,117,51,73,106,107,68,89,89,76,48,77,120,79,52,109,113,115,121,89,106,108,66,97,108,84,86,89,120,70,80,50,115,74,66,75,53,122,108,75,79,66,10,117,122,67,66,117,68,65,102,66,103,78,86,72,83,77,69,71,68,65,87,103,66,81,105,90,81,122,87,87,112,48,48,105,102,79,68,116,74,86,83,118,49,65,98,79,83,99,71,114,68,66,83,66,103,78,86,72,82,56,69,83,122,66,74,10,77,69,101,103,82,97,66,68,104,107,70,111,100,72,82,119,99,122,111,118,76,50,78,108,99,110,82,112,90,109,108,106,89,88,82,108,99,121,53,48,99,110,86,122,100,71,86,107,99,50,86,121,100,109,108,106,90,88,77,117,97,87,53,48,10,90,87,119,117,89,50,57,116,76,48,108,117,100,71,86,115,85,48,100,89,85,109,57,118,100,69,78,66,76,109,82,108,99,106,65,100,66,103,78,86,72,81,52,69,70,103,81,85,73,109,85,77,49,108,113,100,78,73,110,122,103,55,83,86,10,85,114,57,81,71,122,107,110,66,113,119,119,68,103,89,68,86,82,48,80,65,81,72,47,66,65,81,68,65,103,69,71,77,66,73,71,65,49,85,100,69,119,69,66,47,119,81,73,77,65,89,66,65,102,56,67,65,81,69,119,67,103,89,73,10,75,111,90,73,122,106,48,69,65,119,73,68,83,81,65,119,82,103,73,104,65,79,87,47,53,81,107,82,43,83,57,67,105,83,68,99,78,111,111,119,76,117,80,82,76,115,87,71,102,47,89,105,55,71,83,88,57,52,66,103,119,84,119,103,10,65,105,69,65,52,74,48,108,114,72,111,77,115,43,88,111,53,111,47,115,88,54,79,57,81,87,120,72,82,65,118,90,85,71,79,100,82,81,55,99,118,113,82,88,97,113,73,61,10,45,45,45,45,45,69,78,68,32,67,69,82,84,73,70,73,67,65,84,69,45,45,45,45,45,10,0],"qe_identity":[123,34,101,110,99,108,97,118,101,73,100,101,110,116,105,116,121,34,58,123,34,105,100,34,58,34,81,69,34,44,34,118,101,114,115,105,111,110,34,58,50,44,34,105,115,115,117,101,68,97,116,101,34,58,34,50,48,50,51,45,48,53,45,49,53,84,49,52,58,52,56,58,52,48,90,34,44,34,110,101,120,116,85,112,100,97,116,101,34,58,34,50,48,50,51,45,48,54,45,49,52,84,49,52,58,52,56,58,52,48,90,34,44,34,116,99,98,69,118,97,108,117,97,116,105,111,110,68,97,116,97,78,117,109,98,101,114,34,58,49,53,44,34,109,105,115,99,115,101,108,101,99,116,34,58,34,48,48,48,48,48,48,48,48,34,44,34,109,105,115,99,115,101,108,101,99,116,77,97,115,107,34,58,34,70,70,70,70,70,70,70,70,34,44,34,97,116,116,114,105,98,117,116,101,115,34,58,34,49,49,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,34,44,34,97,116,116,114,105,98,117,116,101,115,77,97,115,107,34,58,34,70,66,70,70,70,70,70,70,70,70,70,70,70,70,70,70,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,34,44,34,109,114,115,105,103,110,101,114,34,58,34,56,67,52,70,53,55,55,53,68,55,57,54,53,48,51,69,57,54,49,51,55,70,55,55,67,54,56,65,56,50,57,65,48,48,53,54,65,67,56,68,69,68,55,48,49,52,48,66,48,56,49,66,48,57,52,52,57,48,67,53,55,66,70,70,34,44,34,105,115,118,112,114,111,100,105,100,34,58,49,44,34,116,99,98,76,101,118,101,108,115,34,58,91,123,34,116,99,98,34,58,123,34,105,115,118,115,118,110,34,58,56,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,50,51,45,48,50,45,49,53,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,85,112,84,111,68,97,116,101,34,125,44,123,34,116,99,98,34,58,123,34,105,115,118,115,118,110,34,58,54,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,50,49,45,49,49,45,49,48,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,93,125,44,123,34,116,99,98,34,58,123,34,105,115,118,115,118,110,34,58,53,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,50,48,45,49,49,45,49,49,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,52,55,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,93,125,44,123,34,116,99,98,34,58,123,34,105,115,118,115,118,110,34,58,52,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,49,57,45,49,49,45,49,51,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,51,51,52,34,44,34,73,78,84,69,76,45,83,65,45,48,48,52,55,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,93,125,44,123,34,116,99,98,34,58,123,34,105,115,118,115,118,110,34,58,50,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,49,57,45,48,53,45,49,53,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,50,49,57,34,44,34,73,78,84,69,76,45,83,65,45,48,48,50,57,51,34,44,34,73,78,84,69,76,45,83,65,45,48,48,51,51,52,34,44,34,73,78,84,69,76,45,83,65,45,48,48,52,55,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,93,125,44,123,34,116,99,98,34,58,123,34,105,115,118,115,118,110,34,58,49,125,44,34,116,99,98,68,97,116,101,34,58,34,50,48,49,56,45,48,56,45,49,53,84,48,48,58,48,48,58,48,48,90,34,44,34,116,99,98,83,116,97,116,117,115,34,58,34,79,117,116,79,102,68,97,116,101,34,44,34,97,100,118,105,115,111,114,121,73,68,115,34,58,91,34,73,78,84,69,76,45,83,65,45,48,48,50,48,50,34,44,34,73,78,84,69,76,45,83,65,45,48,48,50,49,57,34,44,34,73,78,84,69,76,45,83,65,45,48,48,50,57,51,34,44,34,73,78,84,69,76,45,83,65,45,48,48,51,51,52,34,44,34,73,78,84,69,76,45,83,65,45,48,48,52,55,55,34,44,34,73,78,84,69,76,45,83,65,45,48,48,54,49,53,34,93,125,93,125,44,34,115,105,103,110,97,116,117,114,101,34,58,34,57,55,102,102,56,57,53,55,57,55,53,98,52,48,97,97,53,49,97,49,55,55,54,53,100,55,51,52,51,54,51,98,56,99,98,55,53,53,55,101,54,54,53,55,98,48,52,102,54,51,98,54,55,99,48,53,102,50,56,56,54,98,101,49,98,55,99,99,49,52,98,57,99,49,98,56,56,57,101,48,51,98,56,53,56,54,54,101,50,55,55,97,49,48,50,101,98,57,102,98,56,53,48,50,57,98,55,48,48,56,98,52,49,55,53,52,99,100,98,97,48,49,52,97,53,97,56,99,34,125,0]}`
	var expectedExpirationDate = time.Date(2023, 6, 12, 21, 0, 3, 0, time.UTC)
	timeNowFunc = func() time.Time {
		return expectedExpirationDate.Add(-1000 * time.Second)
	}
	mrSigner := "298037d88782e022e019b3020745b78aa40ed95c77da4bf7f3253d3a44c4fd7e"
	mrEnclave := "18946b3547d3ca036f4df7b516857e28fd512d69fed3411dc660537912faabf8"
	logicaltest.Test(t, logicaltest.TestCase{
		CredentialBackend: testFactory(t),
		Steps: []logicaltest.TestStep{
			testAccStepTEE(t, "tee_app_1", "sgx", mrSigner, "", "Ok,SwHardeningNeeded", "foo", false),
			testAccStepLoginWithName(t, connState, "tee_app_1", quoteBase64, collateralJson),
			testAccStepResolveRole(t, connState, "tee_app_1", quoteBase64),
			testAccStepTEE(t, "tee_app_1", "sgx", "", mrEnclave, "Ok,SwHardeningNeeded", "foo", false),
			testAccStepLoginWithName(t, connState, "tee_app_1", quoteBase64, collateralJson),
			testAccStepResolveRole(t, connState, "tee_app_1", quoteBase64),
		},
	})
}

func testAccStepResolveRole(t *testing.T, connState tls.ConnectionState, teeName string, quote string) logicaltest.TestStep {
	return logicaltest.TestStep{
		Operation:       logical.ResolveRoleOperation,
		Path:            "login",
		Unauthenticated: true,
		ConnState:       &connState,
		Check: func(resp *logical.Response) error {
			if resp.Data["role"] != teeName {
				t.Fatalf("Role was not as expected. Expected %s, received %s", teeName, resp.Data["role"])
			}
			return nil
		},
		Data: map[string]interface{}{
			"quote": quote,
		},
	}
}

func TestTee_RoleResolve_RoleDoesNotExist(t *testing.T) {
	connState, err := testConnState("test-fixtures/keys/cert.pem",
		"test-fixtures/keys/key.pem", "test-fixtures/keys/cert.pem")
	if err != nil {
		t.Fatalf("error testing connection state: %v", err)
	}

	quoteBase64 := `AwACAAAAAAAJAA4Ak5pyM/ecTKmUCg2zlX8GB2A9AU1uxwxpErEhhnbcltYAAAAACwsQD///AQAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAADnAAAAAAAAABiUazVH08oDb033tRaFfij9US1p/tNBHcZgU3kS+qv4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApgDfYh4LgIuAZswIHRbeKpA7ZXHfaS/fzJT06RMT9fgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACZe/ri1/kInRdrGLXO8tgd7B/R3DMumyPFU8TgL+PkqwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAxhAAAPvTSIG+2X8S4ne9Zsb8a5wqVabUhgr7r3GlpScrLaGMv8RDLVr9n8O/9CfASa11lqkO1DT+JqFTu+5Mitjp2rm/ptkyoG99YfjwdzdsURZQvQCidBDdhrt1kcr+7HwTFcf1hbifB13klNa6Npsm5sc7SMgVXrVM98+zCj0+jTleCwsQD///AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFQAAAAAAAADnAAAAAAAAABkqpQzhwM7wPM+J57Wxaw15ePXCse3Pd02HcC6BVNi/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMT1d115ZQPpYTf3fGioKaAFasje1wFAsIGwlEkMV7/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEACQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADLZrH69IGHR4/H2DCpkrZPl4lJ7yWZvpARseCwUJ/wmwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGrO+CXpMIu8FYYaLb9gwNsNegCmkZgK72V9wj8LDQmJlvUfpZ+qz4tYm5HucJK8ulPfQMCRoFowZFxLlXF1EiAAAAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8FAF4OAAAtLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJRThUQ0NCSmlnQXdJQkFnSVVEMkNQQzRleDNQcnB6UE9YRXBuVTIrNDMzYm93Q2dZSUtvWkl6ajBFQXdJdwpjREVpTUNBR0ExVUVBd3daU1c1MFpXd2dVMGRZSUZCRFN5QlFiR0YwWm05eWJTQkRRVEVhTUJnR0ExVUVDZ3dSClNXNTBaV3dnUTI5eWNHOXlZWFJwYjI0eEZEQVNCZ05WQkFjTUMxTmhiblJoSUVOc1lYSmhNUXN3Q1FZRFZRUUkKREFKRFFURUxNQWtHQTFVRUJoTUNWVk13SGhjTk1qTXdOVEV3TWpBeU5EVTJXaGNOTXpBd05URXdNakF5TkRVMgpXakJ3TVNJd0lBWURWUVFEREJsSmJuUmxiQ0JUUjFnZ1VFTkxJRU5sY25ScFptbGpZWFJsTVJvd0dBWURWUVFLCkRCRkpiblJsYkNCRGIzSndiM0poZEdsdmJqRVVNQklHQTFVRUJ3d0xVMkZ1ZEdFZ1EyeGhjbUV4Q3pBSkJnTlYKQkFnTUFrTkJNUXN3Q1FZRFZRUUdFd0pWVXpCWk1CTUdCeXFHU000OUFnRUdDQ3FHU000OUF3RUhBMElBQkR1ZQpDOFl2L1JnZ2V5cnV5cWpmUlhydk1ZRjBoUnhRd1dueW9oVXQvd2VjeUxlL2YyREdZSGk1RlNGLzZnUmlTOC9WCjZiYld6bXEycTBsZm9Mei9hMEdqZ2dNT01JSURDakFmQmdOVkhTTUVHREFXZ0JTVmIxM052UnZoNlVCSnlkVDAKTTg0QlZ3dmVWREJyQmdOVkhSOEVaREJpTUdDZ1hxQmNobHBvZEhSd2N6b3ZMMkZ3YVM1MGNuVnpkR1ZrYzJWeQpkbWxqWlhNdWFXNTBaV3d1WTI5dEwzTm5lQzlqWlhKMGFXWnBZMkYwYVc5dUwzWXpMM0JqYTJOeWJEOWpZVDF3CmJHRjBabTl5YlNabGJtTnZaR2x1Wnoxa1pYSXdIUVlEVlIwT0JCWUVGSi95dmhxV0lBd0prOTJIbXpjSWtreWcKMUFDQU1BNEdBMVVkRHdFQi93UUVBd0lHd0RBTUJnTlZIUk1CQWY4RUFqQUFNSUlDT3dZSktvWklodmhOQVEwQgpCSUlDTERDQ0FpZ3dIZ1lLS29aSWh2aE5BUTBCQVFRUXFmNzBJOGRnYksweGVtaEY0TExIM3pDQ0FXVUdDaXFHClNJYjRUUUVOQVFJd2dnRlZNQkFHQ3lxR1NJYjRUUUVOQVFJQkFnRUxNQkFHQ3lxR1NJYjRUUUVOQVFJQ0FnRUwKTUJBR0N5cUdTSWI0VFFFTkFRSURBZ0VETUJBR0N5cUdTSWI0VFFFTkFRSUVBZ0VETUJFR0N5cUdTSWI0VFFFTgpBUUlGQWdJQS96QVJCZ3NxaGtpRytFMEJEUUVDQmdJQ0FQOHdFQVlMS29aSWh2aE5BUTBCQWdjQ0FRRXdFQVlMCktvWklodmhOQVEwQkFnZ0NBUUF3RUFZTEtvWklodmhOQVEwQkFna0NBUUF3RUFZTEtvWklodmhOQVEwQkFnb0MKQVFBd0VBWUxLb1pJaHZoTkFRMEJBZ3NDQVFBd0VBWUxLb1pJaHZoTkFRMEJBZ3dDQVFBd0VBWUxLb1pJaHZoTgpBUTBCQWcwQ0FRQXdFQVlMS29aSWh2aE5BUTBCQWc0Q0FRQXdFQVlMS29aSWh2aE5BUTBCQWc4Q0FRQXdFQVlMCktvWklodmhOQVEwQkFoQUNBUUF3RUFZTEtvWklodmhOQVEwQkFoRUNBUTB3SHdZTEtvWklodmhOQVEwQkFoSUUKRUFzTEF3UC8vd0VBQUFBQUFBQUFBQUF3RUFZS0tvWklodmhOQVEwQkF3UUNBQUF3RkFZS0tvWklodmhOQVEwQgpCQVFHQUdCcUFBQUFNQThHQ2lxR1NJYjRUUUVOQVFVS0FRRXdIZ1lLS29aSWh2aE5BUTBCQmdRUUtEbyt6dWdoCjhaY0xBME9hM3BSa2REQkVCZ29xaGtpRytFMEJEUUVITURZd0VBWUxLb1pJaHZoTkFRMEJCd0VCQWY4d0VBWUwKS29aSWh2aE5BUTBCQndJQkFRQXdFQVlMS29aSWh2aE5BUTBCQndNQkFRQXdDZ1lJS29aSXpqMEVBd0lEUndBdwpSQUlnRHBmZFptVE5IYnVRaFE0c0ZMSnZ5czIzY2ZxdWR1ODBZcUlEVm5ud2NPRUNJRmhUMFF2R2xqS1FSM2NvClBqOGhoSFQ5anVWYXFkM1RydE1YRDFQZEhZWHYKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJQ2xqQ0NBajJnQXdJQkFnSVZBSlZ2WGMyOUcrSHBRRW5KMVBRenpnRlhDOTVVTUFvR0NDcUdTTTQ5QkFNQwpNR2d4R2pBWUJnTlZCQU1NRVVsdWRHVnNJRk5IV0NCU2IyOTBJRU5CTVJvd0dBWURWUVFLREJGSmJuUmxiQ0JECmIzSndiM0poZEdsdmJqRVVNQklHQTFVRUJ3d0xVMkZ1ZEdFZ1EyeGhjbUV4Q3pBSkJnTlZCQWdNQWtOQk1Rc3cKQ1FZRFZRUUdFd0pWVXpBZUZ3MHhPREExTWpFeE1EVXdNVEJhRncwek16QTFNakV4TURVd01UQmFNSEF4SWpBZwpCZ05WQkFNTUdVbHVkR1ZzSUZOSFdDQlFRMHNnVUd4aGRHWnZjbTBnUTBFeEdqQVlCZ05WQkFvTUVVbHVkR1ZzCklFTnZjbkJ2Y21GMGFXOXVNUlF3RWdZRFZRUUhEQXRUWVc1MFlTQkRiR0Z5WVRFTE1Ba0dBMVVFQ0F3Q1EwRXgKQ3pBSkJnTlZCQVlUQWxWVE1Ga3dFd1lIS29aSXpqMENBUVlJS29aSXpqMERBUWNEUWdBRU5TQi83dDIxbFhTTwoyQ3V6cHh3NzRlSkI3MkV5REdnVzVyWEN0eDJ0VlRMcTZoS2s2eitVaVJaQ25xUjdwc092Z3FGZVN4bG1UbEpsCmVUbWkyV1l6M3FPQnV6Q0J1REFmQmdOVkhTTUVHREFXZ0JRaVpReldXcDAwaWZPRHRKVlN2MUFiT1NjR3JEQlMKQmdOVkhSOEVTekJKTUVlZ1JhQkRoa0ZvZEhSd2N6b3ZMMk5sY25ScFptbGpZWFJsY3k1MGNuVnpkR1ZrYzJWeQpkbWxqWlhNdWFXNTBaV3d1WTI5dEwwbHVkR1ZzVTBkWVVtOXZkRU5CTG1SbGNqQWRCZ05WSFE0RUZnUVVsVzlkCnpiMGI0ZWxBU2NuVTlEUE9BVmNMM2xRd0RnWURWUjBQQVFIL0JBUURBZ0VHTUJJR0ExVWRFd0VCL3dRSU1BWUIKQWY4Q0FRQXdDZ1lJS29aSXpqMEVBd0lEUndBd1JBSWdYc1ZraTB3K2k2VllHVzNVRi8yMnVhWGUwWUpEajFVZQpuQStUakQxYWk1Y0NJQ1liMVNBbUQ1eGtmVFZwdm80VW95aVNZeHJEV0xtVVI0Q0k5Tkt5ZlBOKwotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCi0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlDanpDQ0FqU2dBd0lCQWdJVUltVU0xbHFkTkluemc3U1ZVcjlRR3prbkJxd3dDZ1lJS29aSXpqMEVBd0l3CmFERWFNQmdHQTFVRUF3d1JTVzUwWld3Z1UwZFlJRkp2YjNRZ1EwRXhHakFZQmdOVkJBb01FVWx1ZEdWc0lFTnYKY25CdmNtRjBhVzl1TVJRd0VnWURWUVFIREF0VFlXNTBZU0JEYkdGeVlURUxNQWtHQTFVRUNBd0NRMEV4Q3pBSgpCZ05WQkFZVEFsVlRNQjRYRFRFNE1EVXlNVEV3TkRVeE1Gb1hEVFE1TVRJek1USXpOVGsxT1Zvd2FERWFNQmdHCkExVUVBd3dSU1c1MFpXd2dVMGRZSUZKdmIzUWdRMEV4R2pBWUJnTlZCQW9NRVVsdWRHVnNJRU52Y25CdmNtRjAKYVc5dU1SUXdFZ1lEVlFRSERBdFRZVzUwWVNCRGJHRnlZVEVMTUFrR0ExVUVDQXdDUTBFeEN6QUpCZ05WQkFZVApBbFZUTUZrd0V3WUhLb1pJemowQ0FRWUlLb1pJemowREFRY0RRZ0FFQzZuRXdNRElZWk9qL2lQV3NDemFFS2k3CjFPaU9TTFJGaFdHamJuQlZKZlZua1k0dTNJamtEWVlMME14TzRtcXN5WWpsQmFsVFZZeEZQMnNKQks1emxLT0IKdXpDQnVEQWZCZ05WSFNNRUdEQVdnQlFpWlF6V1dwMDBpZk9EdEpWU3YxQWJPU2NHckRCU0JnTlZIUjhFU3pCSgpNRWVnUmFCRGhrRm9kSFJ3Y3pvdkwyTmxjblJwWm1sallYUmxjeTUwY25WemRHVmtjMlZ5ZG1salpYTXVhVzUwClpXd3VZMjl0TDBsdWRHVnNVMGRZVW05dmRFTkJMbVJsY2pBZEJnTlZIUTRFRmdRVUltVU0xbHFkTkluemc3U1YKVXI5UUd6a25CcXd3RGdZRFZSMFBBUUgvQkFRREFnRUdNQklHQTFVZEV3RUIvd1FJTUFZQkFmOENBUUV3Q2dZSQpLb1pJemowRUF3SURTUUF3UmdJaEFPVy81UWtSK1M5Q2lTRGNOb293THVQUkxzV0dmL1lpN0dTWDk0Qmd3VHdnCkFpRUE0SjBsckhvTXMrWG81by9zWDZPOVFXeEhSQXZaVUdPZFJRN2N2cVJYYXFJPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCgA=`
	var expectedExpirationDate = time.Date(2023, 6, 12, 21, 0, 3, 0, time.UTC)
	timeNowFunc = func() time.Time {
		return expectedExpirationDate.Add(-1000 * time.Second)
	}

	logicaltest.Test(t, logicaltest.TestCase{
		CredentialBackend: testFactory(t),
		Steps: []logicaltest.TestStep{
			testAccStepTEE(t, "tee_app_1", "sgx", "298037d88782e022e019b3020745b78aa40ed95c77da4bf7f3253d3a44c4fd7f", "", "Ok,SwHardeningNeeded", "foo", false),
			testAccStepResolveRoleExpectRoleResolutionToFail(t, connState, quoteBase64),
		},
	})
}

func testAccStepResolveRoleExpectRoleResolutionToFail(t *testing.T, connState tls.ConnectionState, quote string) logicaltest.TestStep {
	return logicaltest.TestStep{
		Operation:       logical.ResolveRoleOperation,
		Path:            "login",
		Unauthenticated: true,
		ConnState:       &connState,
		ErrorOk:         true,
		Check: func(resp *logical.Response) error {
			if resp == nil && !resp.IsError() {
				t.Fatalf("Response was not an error: resp:%#v", resp)
			}

			errString, ok := resp.Data["error"].(string)
			if !ok {
				t.Fatal("Error not part of response.")
			}

			if !strings.Contains(errString, "no TEE was matched by this request") {
				t.Fatalf("Error was not due no matching TEE. Error: %s", errString)
			}
			return nil
		},
		Data: map[string]interface{}{
			"quote": quote,
		},
	}
}
